# ==================================
# TCAD Scraper Environment Variables
# ==================================
#
# Copy this file to .env and fill in your values
# Or use Doppler for secrets management

# ==================================
# Environment
# ==================================
NODE_ENV=development
# Options: development, production, test

# ==================================
# Doppler Configuration (Optional)
# ==================================
# If using Doppler for secrets management
# DOPPLER_PROJECT=your-project
# DOPPLER_CONFIG=dev

# ==================================
# Server Configuration
# ==================================
PORT=3001
HOST=0.0.0.0
LOG_LEVEL=info
# Options: error, warn, info, debug
GRACEFUL_SHUTDOWN_TIMEOUT=10000

# ==================================
# Database Configuration
# ==================================
DATABASE_URL=postgresql://user:password@localhost:5432/tcad_scraper
DATABASE_READ_ONLY_URL=postgresql://user:password@localhost:5432/tcad_scraper
DATABASE_CONNECTION_TIMEOUT=10000
DATABASE_POOL_SIZE=10

# ==================================
# Redis Configuration
# ==================================
REDIS_HOST=localhost
REDIS_PORT=6379
# REDIS_PASSWORD=your-redis-password
REDIS_DB=0
REDIS_CONNECTION_TIMEOUT=10000

# ==================================
# Queue Configuration
# ==================================
QUEUE_CONCURRENCY=4
QUEUE_JOB_ATTEMPTS=3
QUEUE_BACKOFF_DELAY=2000
QUEUE_REMOVE_ON_COMPLETE=100
QUEUE_REMOVE_ON_FAIL=50
QUEUE_CLEANUP_INTERVAL=3600000
# 1 hour in ms
QUEUE_CLEANUP_GRACE=86400000
# 24 hours in ms
QUEUE_DASHBOARD_PATH=/admin/queues
QUEUE_DASHBOARD_ENABLED=true

# ==================================
# Rate Limiting Configuration
# ==================================
# API Rate Limiting
API_RATE_LIMIT_WINDOW=900000
# 15 minutes in ms
API_RATE_LIMIT_MAX=100
API_RATE_LIMIT_MESSAGE=Too many requests from this IP, please try again later.

# Scraper Rate Limiting
SCRAPER_RATE_LIMIT_WINDOW=60000
# 1 minute in ms
SCRAPER_RATE_LIMIT_MAX=5
SCRAPER_RATE_LIMIT_MESSAGE=Too many scrape requests, please wait before trying again.
SCRAPER_RATE_LIMIT_DELAY=5000
SCRAPER_RATE_CACHE_CLEANUP=60000

# ==================================
# CORS Configuration
# ==================================
CORS_ALLOWED_ORIGINS=http://localhost:5173,http://localhost:5174,https://alephatx.info,https://www.alephatx.info
CORS_CREDENTIALS=true
CORS_ALLOW_NO_ORIGIN=true

# ==================================
# Security Configuration
# ==================================
# Helmet Settings
HELMET_CORP=cross-origin
HELMET_HSTS_ENABLED=false
HELMET_COOP_ENABLED=false
HELMET_CSP_ENABLED=false
HELMET_OAC_ENABLED=false

# Content Security Policy
CSP_ENABLED=true
CSP_NONCE_LENGTH=16
# CSP_DEFAULT_SRC='self'
# CSP_SCRIPT_SRC='self'
# CSP_STYLE_SRC='self','unsafe-inline'
# CSP_IMG_SRC='self',data:,https:
# CSP_FONT_SRC='self',data:
# CSP_CONNECT_SRC='self'
# CSP_FRAME_ANCESTORS='none'
# CSP_BASE_URI='self'
# CSP_FORM_ACTION='self'

# HSTS (HTTP Strict Transport Security)
HSTS_MAX_AGE=31536000
# 1 year in seconds
HSTS_INCLUDE_SUBDOMAINS=true

# ==================================
# Authentication Configuration
# ==================================
# API Key (optional)
# API_KEY=your-secure-api-key

# JWT Settings
JWT_SECRET=your-jwt-secret-change-in-production
JWT_EXPIRES_IN=7d
AUTH_SKIP_IN_DEVELOPMENT=true

# ==================================
# Scraper Configuration
# ==================================
# TCAD API Token (optional - if not set, will capture from browser)
# Get this token by inspecting network requests on travis.prodigycad.com
# TCAD_API_KEY=your-tcad-api-token

# TCAD Token Auto-Refresh (optional - automatically refreshes token)
TCAD_AUTO_REFRESH_TOKEN=true
# Refresh interval in milliseconds (default: 270000ms = 4.5 minutes)
TCAD_TOKEN_REFRESH_INTERVAL=270000
# OR use cron schedule (if set, takes precedence over interval)
# TCAD_TOKEN_REFRESH_CRON=*/4 * * * *

SCRAPER_HEADLESS=true
SCRAPER_TIMEOUT=30000
SCRAPER_RETRY_ATTEMPTS=3
SCRAPER_RETRY_DELAY=2000
SCRAPER_HUMAN_DELAY_MIN=100
SCRAPER_HUMAN_DELAY_MAX=500

# User Agents (comma-separated)
# SCRAPER_USER_AGENTS=Mozilla/5.0 (Windows NT 10.0; Win64; x64)...,Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7)...

# Viewports (JSON array)
# SCRAPER_VIEWPORTS=[{"width":3840,"height":2160},{"width":2560,"height":1440},{"width":1920,"height":1080}]

# Generic Proxy Settings (optional)
SCRAPER_PROXY_ENABLED=false
# SCRAPER_PROXY_SERVER=http://proxy.example.com:8080
# SCRAPER_PROXY_USERNAME=your-username
# SCRAPER_PROXY_PASSWORD=your-password

# Bright Data Proxy (optional)
BRIGHT_DATA_ENABLED=false
# BRIGHT_DATA_API_TOKEN=your-bright-data-token
# BRIGHT_DATA_PROXY_HOST=brd.superproxy.io
# BRIGHT_DATA_PROXY_PORT=22225

# ==================================
# Claude AI Configuration
# ==================================
ANTHROPIC_API_KEY=your-anthropic-api-key
CLAUDE_MODEL=claude-3-haiku-20240307
# Options: claude-3-haiku-20240307, claude-3-sonnet-20240229, claude-3-opus-20240229
CLAUDE_MAX_TOKENS=1024
CLAUDE_TIMEOUT=30000

# ==================================
# Logging Configuration
# ==================================
LOG_LEVEL=info
# Options: error, warn, info, debug
LOG_FORMAT=json
# Options: json, simple
LOG_COLORIZE=true
LOG_ERROR_FILE=logs/error.log
LOG_COMBINED_FILE=logs/combined.log
LOG_FILES_ENABLED=true
LOG_CONSOLE_ENABLED=true

# ==================================
# Frontend Configuration
# ==================================
FRONTEND_URL=http://localhost:5173
API_URL=/api
VITE_API_URL=http://localhost:3001/api
APP_VERSION=1.0.0

# Feature Flags
FEATURE_SEARCH=true
FEATURE_ANALYTICS=false
FEATURE_MONITORING=false

# ==================================
# Monitoring & Metrics Configuration
# ==================================
MONITORING_ENABLED=false

# Sentry (optional)
SENTRY_ENABLED=false
# SENTRY_DSN=your-sentry-dsn
# SENTRY_ENVIRONMENT=development
# SENTRY_TRACES_SAMPLE_RATE=0.1
